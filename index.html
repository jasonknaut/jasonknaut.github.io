<!doctype html>
<html lang="en">
<head>
  <title>CS498 Data Viz -- Final Project</title>
  <link href="css/main.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Libre+Baskerville|Roboto:100,300,400,700" rel="stylesheet">
  <script type="text/javascript" src="js/slideviz.js"></script>
  <script type="text/javascript" src="https://d3js.org/d3.v4.js"></script>
  <meta charset='utf-8'>
</head>
<body>
  <div id="content">

    <!-- Slide: About this Visualiztion -->
    <div class="slide-contents offscreen left" id="slide-about" data-next="slide-intro">
      <h2 class="center">About This Visualization.</h2>
    </div>

    <!-- Slide: Introduction to the Visualization -->
    <div class="slide-contents" id="slide-intro" data-next="slide-viz1" data-initial data-hidenav>
      <h1 class="center">Take a Ride Through the <br/>New York City Bikeshare System.</h1>
      <div class="byline">
        <a href="https://www.linkedin.com/in/jknaut" target="_blank">
          <img src="images/me_tiny.jpg" />Jason Knaut
        </a>
      </div>
      <p class="abstract">
        In 2017, Citibike&#8212;New York City's bikeshare network&#8212;enabled residents, commuters, and
        visitors to take more than [xx] rides throughout the city. The following visualizations explore
        a year of rides across the city, including utilization across individual bikeshare stations, seasonality,
        and intra-day demand patterns, to bring the network to life.
      </p>
        <button id="about-btn" class="text-btn"><img src="images/info-round.svg" alt="About this Visulization">About this Visualization</button>
        <br />

        <button id="start-btn" class="btn-round pulse"><img src="images/right-arrow.svg" alt="Start"></button>
    </div>

    <!-- Data Viz Slide #1: Monthly Ride Data Plotted on a Geomap of the Citibike System -->
    <div class="slide-contents offscreen right" id="slide-viz1" data-next="slide-viz2" data-prev="slide-intro">
      <h2 class="center">2017 Citibike Rides by Station</h2>
      <div id="map-container">
      </div>
    </div>

    <!-- Data Viz Slide #2: Ride Frequency by Day of Week -->
    <div class="slide-contents offscreen right" id="slide-viz2" data-next="slide-viz3" data-prev="slide-viz1">
      <h2 class="center">Slide 3</h2>
    </div>

    <!-- Data Viz Slide #3: Distribution of Rides by Time of Day -->
    <div class="slide-contents offscreen right" id="slide-viz3" data-prev="slide-viz2">
      <h2 class="center">Slide 4</h2>
    </div>


    <!-- Navigation to select slides in the slideshow -->
    <div id="slide-nav" class="hidden">
        <button id="slide-btn1" class="slide-btn selected" data-linkedto="slide-intro"><img src="images/home.svg" alt="Home"></button>
        <button id="slide-btn2" class="slide-btn" data-linkedto="slide-viz1">1</button>
        <button id="slide-btn3" class="slide-btn" data-linkedto="slide-viz2">2</button>
        <button id="slide-btn4" class="slide-btn" data-linkedto="slide-viz3">3</button>
    </div>
  </div>
  <div id="left-nav" class="hidden"><div id="slide-prev-btn" class="btn-round small"><img src="images/left-arrow.svg" alt="Go Back"></div></div>
  <div id="right-nav" class="hidden"><div id="slide-next-btn" class="btn-round small"><img src="images/right-arrow.svg" alt="Go Forward"></div></div>

  <script type="text/javascript">

    /** ------------- SETUP INTERACTIVE SLIDESHOW UI ------------- **/
    slideviz.setup();


    /** ------------- COLORS ------------- **/
    colors = {
      "navy": "#00192e",
      "dark_blue": "#002040",
      "blue": "#033c66",
      "light_blue": "#13639f"
    }

    /** ------------- D3 SETUP ------------- **/

    d3.queue()
      .defer(d3.json, "data/nyc-neighborhoods.geojson")
      .defer(d3.csv, "data/citibike_2017_rides_by_station.csv")
      .defer(d3.csv, "data/citibike_2017_rides_by_day_and_hour.csv")
      .defer(d3.csv, "data/citibike_2017_rides_by_weather.csv")
      .await(ready);

    function ready(error, map_data, rides_data, intraday_data, weather_data) {
      console.log("Finished loading.");
      console.log(map_data[0]);
      create_map_viz(map_data);
    }

    /** ------------- RIDES BY STATION VIZ ------------- **/

    function create_map_viz(map_data) {
      const map_width = 500;
      const map_height = 700;
      const map_scale = 160000;
      const map_lat = -73.9812;
      const map_lon = 40.7331;

      var projection = d3.geoMercator()
                         .scale(map_scale)
                         .center([map_lat, map_lon])
                         .translate([map_width / 2, map_height / 2]);

      var path = d3.geoPath().projection(projection);

      var svg = d3.select('#map-container')
                  .append('svg')
                  .attr('width', map_width)
                  .attr('height', map_height);

      var g = svg.append('g');

      var mapLayer = g.append('g').classed('map-layer', true);
      mapLayer.selectAll('path')
               .data(map_data.features)
               .enter().append('path')
               .attr('d', path)
               .style('fill', colors.blue)
               .style('stroke', colors.dark_blue);
    }


    /** ------------- TIME OF DAY DATA VIZ ------------- **/


  </script>
</body>
</html>
